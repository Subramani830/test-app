[
 {
  "allow_guest": 0,
  "api_method": "insert_barcode",
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "modified": "2021-05-17 14:10:40.578598",
  "name": "insert_item_barcode",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "reference_doctype": null,
  "script": "item_code=frappe.form_dict.get(\"item_code\")\ndocval=frappe.db.get_value(\"Item Barcode\",{\"parent\":item_code,\"parenttype\":\"Item\",\"barcode\":item_code},\"barcode\")\nif not docval:\n    doc = frappe.get_doc('Item',item_code )\n    doc.append('barcodes', {\n    'barcode': item_code,\n    'system_generated_barcode': 1\n    })\n    doc.save()\n    frappe.response['message']=doc\nelse:\n    frappe.response['message'] = \"barcode not inserted\"",
  "script_type": "API"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "modified": "2021-06-08 11:34:10.710382",
  "name": "item_codification",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "reference_doctype": "Item",
  "script": "if doc.variant_of and doc.is_sales_item == 1:\n    if doc.updated_item == 0:\n        for attribute_list in doc.attributes:\n            abbr=frappe.db.get_value(\"Item Attribute Value\",{\"parent\":attribute_list.attribute,\"attribute_value\":attribute_list.attribute_value,\"parenttype\":\"Item Attribute\"},\"abbr\")\n            if(\"colour\" in attribute_list.attribute.lower() or \"color\" in attribute_list.attribute.lower()):\n                color_abbr=abbr\n            elif(\"size\" in attribute_list.attribute.lower()):\n                size_abbr=abbr\n        res = str(doc.variant_of)+str(color_abbr)+\"-\"+str(size_abbr)\n        doc.item_code=res\n        doc.updated_item = 1",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Submit",
  "modified": "2021-05-17 16:59:08.846944",
  "name": "send_mail_for_order_qty",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "reference_doctype": "Sales Order",
  "script": "warehouse_list=[]\nfor item in doc.items:\n    if item.warehouse not in warehouse_list:\n        warehouse_list.append(item.warehouse)\nsend_email_flag=False\n\nfor warehouse in warehouse_list:\n    warehouse_manager_user=frappe.db.get_value('Warehouse',{'name':warehouse},'warehouse_manager')\n    if warehouse_manager_user:\n        email_address=frappe.db.get_value('User',{'name':warehouse_manager_user},'email')\n        first_name=frappe.db.get_value('User',{'name':warehouse_manager_user},'first_name')\n        item_list=frappe.db.get_list('Sales Order Item',\n        filters={\n            'parent':doc.name,\n            'warehouse':warehouse\n        },\n        fields=['item_name','name']\n        )\n        if item_list:\n            content1=\"Dear \"+first_name+\",\"+\"<br>\"+\"<br>\"+\"This is to inform you that the Ordered Quantity for \"\n            for items in item_list:\n                item_doc=frappe.get_doc('Sales Order Item',items.name) \n                if item_doc:\n                    if item_doc.qty>=item_doc.actual_qty:\n                        content1=content1+\"<b>\"+ items.item_name+\"</b>\"+\",\"\n                        send_email_flag=True\n            if send_email_flag==True:\n                frappe.sendmail(recipients=email_address,\n            \t\tsubject=\"Stock Availability Notification\",\n            \t\tmessage= content1+\" is more than the available quantity at \"+\"<b>\"+warehouse+\"</b>\"+\". Please follow with the team to avoid any shortage. \"+\"<br>\"+\"<br>\"+\n            \"Thanks and Regards,\"+\"<br>\"+\"<b>\"+\n        doc.company+\"</b>\")",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "After Submit",
  "modified": "2021-05-17 16:59:15.363258",
  "name": "send_email_to_warehouse_manager",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "reference_doctype": "Sales Order",
  "script": "warehouse_list=[]\nfor item in doc.items:\n    if item.warehouse not in warehouse_list:\n        warehouse_list.append(item.warehouse)\n        \n        \nfor warehouse in warehouse_list:\n        warehouse_manager_user=frappe.db.get_value('Warehouse',{'name':warehouse},'warehouse_manager')\n        if warehouse_manager_user:\n            email_address=frappe.db.get_value('User',{'name':warehouse_manager_user},'email')\n            first_name=frappe.db.get_value('User',{'name':warehouse_manager_user},'first_name')\n            my_attachments = [frappe.attach_print(doc.doctype, doc.name, file_name=doc.name)]\n            frappe.sendmail(recipients=email_address,\n                \t\tsubject=\"Sales Order -\"+doc.name+\" Confirmation notice\",\n                \t\tmessage= \"Dear \"+first_name+\",\"+\"<br>\"+\"<br>\"+\n                \t\t\" This message is to let you know that the following items have been ordered by the customer <b>\"+doc.customer+\"</b>.The details of the order have been enclosed within this mail for your reference.Order Number: <b>\"+doc.name+\"</b>.\"+\n                \t\t\"<br>\"+\"<br>\"+\n                \"Thanks and Regards,\"+\"<br>\"+\"<b>\"+\n                doc.company+\"</b>\",\n                reference_doctype=doc.doctype,\n            \treference_name=doc.name,\n            \tattachments=my_attachments)",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Submit",
  "modified": "2021-07-01 11:06:18.779594",
  "name": "Stock Reconciliation Before Submit",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "reference_doctype": "Stock Reconciliation",
  "script": "if doc.purpose==\"Opening Stock\":\n    for items in frappe.db.get_list(\"Stock Reconciliation Item\",filters={\"parenttype\":\"Stock Reconciliation\",\"parent\":doc.name},fields={\"item_code\"}):\n        docval=frappe.db.get_value(\"Item Barcode\",{\"parent\":items.item_code,\"parenttype\":\"Item\",\"barcode\":items.item_code},\"barcode\")\n        if not docval:\n            item_doc = frappe.get_doc('Item',items.item_code )\n            item_doc.append('barcodes', {\n            'barcode': items.item_code,\n            'system_generated_barcode': 1\n            })\n            item_doc.save()",
  "script_type": "DocType Event"
 },
 {
  "allow_guest": 0,
  "api_method": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Submit",
  "modified": "2021-07-01 11:23:05.479730",
  "name": "Stock Entry Before Submit",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "reference_doctype": "Stock Entry",
  "script": "if doc.stock_entry_type==\"Material Receipt\":\n    for items in frappe.db.get_list(\"Stock Entry Detail\",filters={\"parenttype\":\"Stock Entry\",\"parent\":doc.name},fields={\"item_code\"}):\n        docval=frappe.db.get_value(\"Item Barcode\",{\"parent\":items.item_code,\"parenttype\":\"Item\",\"barcode\":items.item_code},\"barcode\")\n        if not docval:\n            item_doc = frappe.get_doc('Item',items.item_code )\n            item_doc.append('barcodes', {\n            'barcode': items.item_code,\n            'system_generated_barcode': 1\n            })\n            item_doc.save()",
  "script_type": "DocType Event"
 }
]
[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item Attribute",
  "enabled": 1,
  "modified": "2021-07-26 08:34:31.713298",
  "name": "Item Attribute-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Item Attribute', {\n\trefresh(frm) {\n\t    var abbr_field = frappe.meta.get_docfield(\"Item Attribute Value\",\"abbr\", cur_frm.doc.name);\n            abbr_field.set_only_once = 1;\n\t},\n\tbefore_save: function(frm,cdt,cdn){\n\t    $.each(frm.doc.item_attribute_values, function(idx,item){\n\t       var name=frm.doc.name;\n\t       var str = name.toLowerCase();\n\t       if(str.includes(\"size\")){\n    \t    if(item.abbr.length>=4){\n    \t        frappe.validate=false;\n    \t        frappe.throw(__(\"The abbreviation length should be less than 3 characters. The maximum field length has been exceeded, please update.\"))\n    \t    }\n    \t}\n\t       if(str.includes(\"colour\")){\n    \t    if(item.abbr.length>=3){\n    \t        frappe.validate=false;\n    \t        frappe.throw(__(\"The abbreviation length should be less than 2 characters. The maximum field length has been exceeded, please update.\"))\n    \t    }\n    \t}\n\t       if(str.includes(\"color\")){\n    \t    if(item.abbr.length>=3){\n    \t        frappe.validate=false;\n    \t        frappe.throw(__(\"The abbreviation length should be less than 2 characters. The maximum field length has been exceeded, please update.\"))\n    \t    }\n    \t}\n\t    })\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2021-09-15 12:18:45.657011",
  "name": "Item-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Item', {\n    refresh: function(frm){\n        if(frm.doc.has_variants != 1 && frm.doc.__islocal != 1){\n            frm.add_custom_button(\"Generate Barcode\", function() {\n\t\t        frappe.call({\n    \t\t    type:\"POST\",\n    \t\t\targs:{\n    \t\t\t\t'item_code': frm.doc.item_code\n    \t\t\t},\n    \t\t\tasync:false,\n    \t\t\turl: \"/api/method/insert_barcode\",\n    \t\t\tcallback: function(r){\n\n    \t\t\t}\n    \t\t})\n    \t\tlocation.reload();\n\t        })\n        }\n\tfrm.set_query(\"style_number\",function(){\n        return{\n    \t\tfilters: {\n    \t\t    \"disabled\":[\"!=\",1],\n    \t\t  }\n        };\n    });\n    },\n\tbefore_save: function(frm){\n\t    var brand;\n\t    var year;\n\t    var collection;\n\t    var sub_category;\n\t    var category;\n\t    var style;\n\t    var res;\n\t    if(frm.doc.variant_of == undefined && frm.doc.is_sales_item == 1){\n\t        brand = frm.doc.brand_code;\n\t        year = frm.doc.launch_year;\n\t        collection = frm.doc.collection_code;\n\t        style = frm.doc.style_number;\n\t        frappe.db.get_value(\"Item Group\",{\"name\":frm.doc.item_group},[\"sub_category_code\",\"parent_item_group\"],(s)=>{\n\t          sub_category=s.sub_category_code;\n\t          frappe.db.get_value(\"Item Group\",{\"name\":s.parent_item_group},\"category_code\",(c)=>{\n\t              category=c.category_code\n\t              if(category == undefined && sub_category != undefined){\n\t             res = brand.concat(year,collection,sub_category,style)\n\t              }else if(category != undefined && sub_category == undefined) {\n\t             res = brand.concat(year,collection,category,style)\n\t              }else if(category != undefined && sub_category != undefined) {\n\t             res = brand.concat(year,collection,category,sub_category,style)\n\t              }else if(category == undefined && sub_category == undefined) {\n\t             res = brand.concat(year,collection,style)\n\t              }\n\t              frm.set_value(\"item_code\",res);\n\t              frm.refresh_field(\"item_code\");\n\t          })\n\t        });\n\t    }\n\t    else{}\n\t    if(frm.doc.variant_of == undefined && frm.doc.is_sales_item != 1 && frm.doc.intermediate_product == 1){\n\t        brand = frm.doc.brand_code;\n\t        year = frm.doc.launch_year;\n\t        collection = frm.doc.collection_code;\n\t        style = frm.doc.style_number;\n\t        frappe.db.get_value(\"Item Group\",{\"name\":frm.doc.item_group},[\"sub_category_code\",\"parent_item_group\"],(s)=>{\n\t          sub_category=s.sub_category_code;\n\t          frappe.db.get_value(\"Item Group\",{\"name\":s.parent_item_group},\"category_code\",(c)=>{\n\t              category=c.category_code\n\t              if(category == undefined && sub_category != undefined){\n\t             res = brand.concat(year,collection,sub_category,style)\n\t              }else if(category != undefined && sub_category == undefined) {\n\t             res = brand.concat(year,collection,category,style)\n\t              }else if(category != undefined && sub_category != undefined) {\n\t             res = brand.concat(year,collection,category,sub_category,style)\n\t              }else if(category == undefined && sub_category == undefined) {\n\t             res = brand.concat(year,collection,style)\n\t              }\n\t              frm.set_value(\"item_code\",\"I-\"+res);\n\t              frm.refresh_field(\"item_code\");\n\t          })\n\t        });\n\t    }\n\t    var count = 0;\n\t    if(frm.doc.has_variants == 1){\n\t        $.each(frm.doc.attributes, function(idx,item){\n\t            var name=item.attribute;\n\t            var str = name.toLowerCase();\n\t            if(str.includes(\"size\")){\n\t                count= count +1\n\t            }\n\t            if(str.includes(\"colour\") || str.includes(\"color\")){\n\t                count= count +1\n\t            }\n\t        })\n\t        if(count<2){\n\t            frappe.validate=false;\n\t            frappe.throw(__(\"For variants item, attributes table should have both colour and size attributes.\"))\n\t        }\n\t    }\n\t    count=0;\n\t    if(frm.doc.has_variants == 1 && frm.doc.intermediate_product == 1){\n\t        $.each(frm.doc.attributes, function(idx,item){\n\t            var name=item.attribute;\n\t            var str = name.toLowerCase();\n\t            if(str.includes(\"size\")){\n\t                count= count +1\n\t            }\n\t            if(str.includes(\"colour\") || str.includes(\"color\")){\n\t                count= count +1\n\t            }\n\t            if(str.includes(\"stage\")){\n\t                count= count +1\n\t            }\n\t        })\n\t        if(count<3){\n\t            frappe.validate=false;\n\t            frappe.throw(__(\"For variants item, attributes table should have colour, size, stage attributes.\"))\n\t        }\n\t    }\n\t}\n})\n\nfrappe.ui.form.on('Item Barcode', {\n\trefresh(frm) {\n\t},\n\tbefore_barcodes_remove: function(frm, cdt, cdn) {\n\t    var row = locals[cdt][cdn];\n\t    if(row.system_generated_barcode==1){\n    \t    frappe.validate = false;\n    \t \tfrappe.throw(__(\"Unable to delete the system generated Barcode.\"));\n\t    }\n\t}\n})\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Stock Entry",
  "enabled": 1,
  "modified": "2021-07-26 14:59:26.655116",
  "name": "Stock Entry-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Stock Entry', {\n\trefresh(frm) {\n\t    if(frm.doc.__islocal){\n    \t\tfrappe.db.get_value(\"Fiscal Year\",{\"disabled\":0,\"year_start_date\":[\"<=\",frm.doc.posting_date],\"year_end_date\":[\">=\",frm.doc.posting_date]},\"year\",(y)=>{\n    \t\t        frm.set_value(\"financial_year\",y.year)\n    \t\t})\n\t\t}\t    \n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Delivery Note",
  "enabled": 1,
  "modified": "2021-07-26 14:58:59.515690",
  "name": "Delivery Note-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Delivery Note', {\nrefresh: function(frm) {\n    if(frm.doc.__islocal){\n\t\tfrappe.db.get_value(\"Fiscal Year\",{\"disabled\":0,\"year_start_date\":[\"<=\",frm.doc.posting_date],\"year_end_date\":[\">=\",frm.doc.posting_date]},\"year\",(y)=>{\n\t\t        frm.set_value(\"financial_year\",y.year)\n\t\t})\n\t}\nset_css(frm);\n}\n});\n\nvar set_css = function (frm) {\n    $('input[data-fieldname=\"tracking_id\"]').css(\"color\",\"blue\")\n}\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Packing Slip",
  "enabled": 1,
  "modified": "2021-07-26 14:58:27.747961",
  "name": "Packing Slip-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Packing Slip', {\n\trefresh(frm) {\n\t    if(frm.doc.__islocal){\n    \t\tfrappe.db.get_value(\"Fiscal Year\",{\"disabled\":0,\"year_start_date\":[\"<=\",frappe.utils.nowdate],\"year_end_date\":[\">=\",frappe.utils.nowdate]},\"year\",(y)=>{\n    \t\t        frm.set_value(\"financial_year\",y.year)\n    \t\t})\n\t\t}\n\t},\n\tbox_no(frm) {\n    \tif(frm.doc.items != undefined){\n    \t\t\tfor(var i =0;i<cur_frm.doc.items.length;i++){\n    \t\t\t\tcur_frm.doc.items[i].box_no=cur_frm.doc.box_no\n    \t\t\t}\n    \t\t}\n    \t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Sales Invoice",
  "enabled": 1,
  "modified": "2021-07-26 09:28:57.226096",
  "name": "Sales Invoice-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Sales Invoice', {\n\trefresh(frm) {\n\t   if(frm.doc.__islocal){\n    \t\tfrappe.db.get_value(\"Fiscal Year\",{\"disabled\":0,\"year_start_date\":[\"<=\",frm.doc.posting_date],\"year_end_date\":[\">=\",frm.doc.posting_date]},\"year\",(y)=>{\n    \t\t        frm.set_value(\"financial_year\",y.year)\n    \t\t})\n\t\t}\n\t    if(frm.doc.delivery_note == undefined)\n\t\t$.each(frm.doc.items,function(idx, item){\n            if(item.delivery_note != undefined){\n                frm.set_value(\"delivery_note\",item.delivery_note)\n            }\n\t\t});\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Sales Order",
  "enabled": 1,
  "modified": "2021-07-26 09:29:24.160483",
  "name": "Sales Order-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Sales Order', {\n\trefresh(frm) {\n\t    if(frm.doc.__islocal){\n    \t\tfrappe.db.get_value(\"Fiscal Year\",{\"disabled\":0,\"year_start_date\":[\"<=\",frm.doc.transaction_date],\"year_end_date\":[\">=\",frm.doc.transaction_date]},\"year\",(y)=>{\n    \t\t        frm.set_value(\"financial_year\",y.year)\n    \t\t})\n\t\t}\n\t}\n\t\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "POS Invoice",
  "enabled": 1,
  "modified": "2021-07-26 09:30:23.639904",
  "name": "POS Invoice-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('POS Invoice', {\n    refresh(frm) {\n\t    if(frm.doc.__islocal){\n    \t\tfrappe.db.get_value(\"Fiscal Year\",{\"disabled\":0,\"year_start_date\":[\"<=\",frm.doc.posting_date],\"year_end_date\":[\">=\",frm.doc.posting_date]},\"year\",(y)=>{\n    \t\t        frm.set_value(\"financial_year\",y.year)\n    \t\t})\n\t\t}\n\t},\n    validate(frm){\n        if(frm.doc.transaction_id!=null && frm.doc.transaction_id!=undefined){\n\t        for(var i=0;i<frm.doc.payments.length;i++){\n\t            if(frm.doc.payments[i].mode_of_payment==\"Online\" && frm.doc.payments[i].mode_of_payment!=undefined && frm.doc.payments[i].base_amount>0){\n\t                frm.doc.payments[i].transaction_id=frm.doc.transaction_id\n\t            }\n\t            if(frm.doc.is_return==1){\n\t                if(frm.doc.payments[i].mode_of_payment==\"Online\" && frm.doc.payments[i].mode_of_payment!=undefined && frm.doc.payments[i].base_amount<0){\n\t                    frm.doc.payments[i].transaction_id=frm.doc.transaction_id\n\t                   } \n\t                }\n\t        }\n\t    }\n\t    if(frm.doc.payment_source!=null && frm.doc.payment_source!=undefined){\n\t        for(var k=0;k<frm.doc.payments.length;k++){\n\t            if(frm.doc.payments[k].mode_of_payment==\"Online\" && frm.doc.payments[k].mode_of_payment!=undefined && frm.doc.payments[k].base_amount>0){\n\t                frm.doc.payments[k].payment_source=frm.doc.payment_source\n\t            }\n\t            if(frm.doc.is_return==1){\n\t                if(frm.doc.payments[k].mode_of_payment==\"Online\" && frm.doc.payments[k].mode_of_payment!=undefined && frm.doc.payments[k].base_amount<0){\n\t                    frm.doc.payments[k].payment_source=frm.doc.payment_source\n\t                }\n\t            }\n\t        }\n\t    }\n\t\tif (frm.doc.payments!=null) {\n\t\t\tfor(var j=0;j<frm.doc.payments.length;j++){\n\t            if(frm.doc.payments[j].mode_of_payment==\"Online\" && frm.doc.payments[j].mode_of_payment!=undefined && frm.doc.payments[j].base_amount>0){\n\t                if(frm.doc.payments[j].transaction_id==null||frm.doc.payments[j].transaction_id==undefined||frm.doc.payments[j].transaction_id==''){\n\t                    frappe.msgprint(__(\"Unable to submit the invoice due to unavailability of Transaction Id. Please provide the transaction Id to submit the invoice\"));\n\t\t\t            frappe.validated = false;\n\t                }\n\t            }\n\t        }\n\t\t}\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Collection Details",
  "enabled": 1,
  "modified": "2021-07-26 09:32:13.402707",
  "name": "Collection Details-List",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.listview_settings['Collection Details'] = {\n\thide_name_column: true\n};",
  "view": "List"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Style Details",
  "enabled": 1,
  "modified": "2021-07-26 09:32:48.727750",
  "name": "Style Details-List",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.listview_settings['Style Details'] = {\n\thide_name_column: true\n};",
  "view": "List"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Launch Details",
  "enabled": 1,
  "modified": "2021-07-26 09:33:16.514709",
  "name": "Launch Details-List",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.listview_settings['Launch Details'] = {\n\thide_name_column: true\n};",
  "view": "List"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Pick List",
  "enabled": 1,
  "modified": "2021-07-26 14:27:06.280257",
  "name": "Pick List-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Pick List', {\n\trefresh(frm) {\n\t    if(frm.doc.__islocal){\n    \t\tfrappe.db.get_value(\"Fiscal Year\",{\"disabled\":0,\"year_start_date\":[\"<=\",frappe.utils.nowdate],\"year_end_date\":[\">=\",frappe.utils.nowdate]},\"year\",(y)=>{\n    \t\t        frm.set_value(\"financial_year\",y.year)\n    \t\t})\n\t\t}\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Order",
  "enabled": 1,
  "modified": "2021-07-26 14:27:45.304838",
  "name": "Purchase Order-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Purchase Order', {\n\trefresh(frm) {\n\t    if(frm.doc.__islocal){\n    \t\tfrappe.db.get_value(\"Fiscal Year\",{\"disabled\":0,\"year_start_date\":[\"<=\",frm.doc.transaction_date],\"year_end_date\":[\">=\",frm.doc.transaction_date]},\"year\",(y)=>{\n    \t\t        frm.set_value(\"financial_year\",y.year)\n    \t\t})\n\t\t}\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Invoice",
  "enabled": 1,
  "modified": "2021-07-26 14:28:17.967632",
  "name": "Purchase Invoice-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Purchase Invoice', {\n\trefresh(frm) {\n\t    if(frm.doc.__islocal){\n    \t\tfrappe.db.get_value(\"Fiscal Year\",{\"disabled\":0,\"year_start_date\":[\"<=\",frm.doc.posting_date],\"year_end_date\":[\">=\",frm.doc.posting_date]},\"year\",(y)=>{\n    \t\t        frm.set_value(\"financial_year\",y.year)\n    \t\t})\n\t\t}\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Receipt",
  "enabled": 1,
  "modified": "2021-07-26 14:28:55.638628",
  "name": "Purchase Receipt-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Purchase Receipt', {\n\trefresh(frm) {\n\t    if(frm.doc.__islocal){\n    \t\tfrappe.db.get_value(\"Fiscal Year\",{\"disabled\":0,\"year_start_date\":[\"<=\",frm.doc.posting_date],\"year_end_date\":[\">=\",frm.doc.posting_date]},\"year\",(y)=>{\n    \t\t        frm.set_value(\"financial_year\",y.year)\n    \t\t})\n\t\t}\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Payment Order",
  "enabled": 1,
  "modified": "2021-07-26 14:29:22.054788",
  "name": "Payment Order-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Payment Order', {\n\trefresh(frm) {\n\t\t   if(frm.doc.__islocal){\n    \t\tfrappe.db.get_value(\"Fiscal Year\",{\"disabled\":0,\"year_start_date\":[\"<=\",frm.doc.posting_date],\"year_end_date\":[\">=\",frm.doc.posting_date]},\"year\",(y)=>{\n    \t\t        frm.set_value(\"financial_year\",y.year)\n    \t\t})\n\t\t}\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Payment Entry",
  "enabled": 1,
  "modified": "2021-07-26 14:30:00.928411",
  "name": "Payment Entry-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Payment Entry', {\n\trefresh(frm) {\n\t\t   if(frm.doc.__islocal){\n    \t\tfrappe.db.get_value(\"Fiscal Year\",{\"disabled\":0,\"year_start_date\":[\"<=\",frm.doc.posting_date],\"year_end_date\":[\">=\",frm.doc.posting_date]},\"year\",(y)=>{\n    \t\t        frm.set_value(\"financial_year\",y.year)\n    \t\t})\n\t\t}\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Payment Request",
  "enabled": 1,
  "modified": "2021-07-26 14:30:20.420455",
  "name": "Payment Request-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Payment Request', {\n\trefresh(frm) {\n\t\t   if(frm.doc.__islocal){\n    \t\tfrappe.db.get_value(\"Fiscal Year\",{\"disabled\":0,\"year_start_date\":[\"<=\",frm.doc.transaction_date],\"year_end_date\":[\">=\",frm.doc.transaction_date]},\"year\",(y)=>{\n    \t\t        frm.set_value(\"financial_year\",y.year)\n    \t\t})\n\t\t}\n\t}\n})",
  "view": "Form"
 }
]